[
  {
    "target": "Health",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/health-check-kafka.json",
      "/records/health-check-mongo.json",
      "/records/health-check-postgres.json",
      "/records/health-check-sqlserver.json",
      "/records/health-check-mysql.json",
      "/records/health-check-mariadb.json",
      "/records/health-check-oracle.json",
      "/records/health-check-dynamodb.json"
    ]
  },
  {
    "target": "Mongo",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-mongo.json",
      "/records/source-tests-mongo.json"
    ],
    "setup": {
      "database": "kafka_connect_db",
      "scripts": [
        "{ \"create\": \"source-collection\", \"changeStreamPreAndPostImages\": { \"enabled\": true } }",
        "{ \"create\": \"sink-collection\", \"changeStreamPreAndPostImages\": { \"enabled\": true } }"
      ]
    }
  },
  {
    "target": "Postgres",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-postgres.json",
      "/records/source-tests-postgres.json"
    ],
    "setup": {"database":  "kafka_connect_db",
    "scripts": [
      "CREATE TABLE IF NOT EXISTS public.\"source_table\"(\"userId\" text, \"userName\" text, email text, timestamp text, action text);"
    ]}
  },
  {
    "target": "SqlServer",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-sqlserver.json",
      "/records/source-tests-sqlserver.json"
    ],
    "setup": {
      "database": "kafka_connect_db",
      "scripts": [
        "IF OBJECT_ID('[dbo].[source_table]', 'U') IS NOT NULL DROP TABLE [dbo].[source_table]; CREATE TABLE [dbo].[source_table]([userId] NVARCHAR(255), [userName] NVARCHAR(255), [email] NVARCHAR(255), [timestamp] NVARCHAR(255), [action] NVARCHAR(255));"
      ]
    }
  },
  {
    "target": "MySql",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-mysql.json",
      "/records/source-tests-mysql.json"
    ],
    "setup": {
      "database": "kafka_connect_db",
      "scripts": [
        "DROP TABLE IF EXISTS `source_table`; CREATE TABLE `source_table`(`userId` VARCHAR(255), `userName` VARCHAR(255), `email` VARCHAR(255), `timestamp` VARCHAR(255), `action` VARCHAR(255));"
      ]
    }
  },
  {
    "target": "MariaDb",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-mariadb.json",
      "/records/source-tests-mariadb.json"
    ],
    "setup": {
      "database": "kafka_connect_db",
      "scripts": [
        "DROP TABLE IF EXISTS `source_table`; CREATE TABLE `source_table`(`userId` VARCHAR(255), `userName` VARCHAR(255), `email` VARCHAR(255), `timestamp` VARCHAR(255), `action` VARCHAR(255));"
      ]
    }
  },
  {
    "target": "Oracle",
    "schema": "/schemas/user-event.avsc",
    "skip": false,
    "files": [
      "/records/sink-tests-oracle.json",
      "/records/source-tests-oracle.json"
    ],
    "setup": {
      "database": "XE",
      "scripts": [
        "BEGIN EXECUTE IMMEDIATE 'DROP TABLE \"SYSTEM\".\"source_table\"'; EXCEPTION WHEN OTHERS THEN IF SQLCODE != -942 THEN RAISE; END IF; END;",
        "CREATE TABLE \"SYSTEM\".\"source_table\" (\"userId\" VARCHAR2(255), \"userName\" VARCHAR2(255), \"email\" VARCHAR2(255), \"timestamp\" VARCHAR2(255), \"action\" VARCHAR2(255))"
      ]
    }
  },
  {
    "target": "DynamoDb",
    "schema": "/schemas/user-event.avsc",
    "files": [
      "/records/sink-tests-dynamodb.json",
      "/records/source-tests-dynamodb.json"
    ],
    "setup": {
      "database": "",
      "scripts": [
        "{ \"TableName\": \"kafka-connect-sink-table\", \"KeySchema\": [{ \"AttributeName\": \"userId\", \"KeyType\": \"HASH\" }], \"AttributeDefinitions\": [{ \"AttributeName\": \"userId\", \"AttributeType\": \"S\" }] }",
        "{ \"TableName\": \"kafka-connect-source-table\", \"KeySchema\": [{ \"AttributeName\": \"userId\", \"KeyType\": \"HASH\" }], \"AttributeDefinitions\": [{ \"AttributeName\": \"userId\", \"AttributeType\": \"S\" }], \"StreamSpecification\": { \"StreamEnabled\": true, \"StreamViewType\": \"NEW_AND_OLD_IMAGES\" } }",
        "{ \"TableName\": \"kafka-connect-health-table\", \"KeySchema\": [{ \"AttributeName\": \"id\", \"KeyType\": \"HASH\" }], \"AttributeDefinitions\": [{ \"AttributeName\": \"id\", \"AttributeType\": \"S\" }] }"
      ]
    }
  }
]
